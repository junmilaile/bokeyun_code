import{d as e,m as t,a,r as o,o as l,c as s,w as i,j as n,F as r,g as u,e as c,b as d,t as p,f as m,h,n as g,i as f,J as b,D as y,q as v,l as S,K as x,L as _,x as z,y as C,z as T,M as k,N as w,O as M}from"./index-6f7f74a6.js";import{_ as N}from"./u-loading-icon.4e942fd2.js";import{r as P,o as $,b as F}from"./uni-app.es.6c04d0ca.js";import{_ as I,b as j,c as B}from"./tools.321430c8.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";const O=G({name:"u-button",mixins:[t,a,{props:{hairline:{type:Boolean,default:e.button.hairline},type:{type:String,default:e.button.type},size:{type:String,default:e.button.size},shape:{type:String,default:e.button.shape},plain:{type:Boolean,default:e.button.plain},disabled:{type:Boolean,default:e.button.disabled},loading:{type:Boolean,default:e.button.loading},loadingText:{type:[String,Number],default:e.button.loadingText},loadingMode:{type:String,default:e.button.loadingMode},loadingSize:{type:[String,Number],default:e.button.loadingSize},openType:{type:String,default:e.button.openType},formType:{type:String,default:e.button.formType},appParameter:{type:String,default:e.button.appParameter},hoverStopPropagation:{type:Boolean,default:e.button.hoverStopPropagation},lang:{type:String,default:e.button.lang},sessionFrom:{type:String,default:e.button.sessionFrom},sendMessageTitle:{type:String,default:e.button.sendMessageTitle},sendMessagePath:{type:String,default:e.button.sendMessagePath},sendMessageImg:{type:String,default:e.button.sendMessageImg},showMessageCard:{type:Boolean,default:e.button.showMessageCard},dataName:{type:String,default:e.button.dataName},throttleTime:{type:[String,Number],default:e.button.throttleTime},hoverStartTime:{type:[String,Number],default:e.button.hoverStartTime},hoverStayTime:{type:[String,Number],default:e.button.hoverStayTime},text:{type:[String,Number],default:e.button.text},icon:{type:String,default:e.button.icon},iconColor:{type:String,default:e.button.icon},color:{type:String,default:e.button.color}}}],data:()=>({}),computed:{bemClass(){return this.color?this.bem("button",["shape","size"],["disabled","plain","hairline"]):this.bem("button",["type","shape","size"],["disabled","plain","hairline"])},loadingColor(){return this.plain?this.color?this.color:uni.$u.config.color[`u-${this.type}`]:"info"===this.type?"#c9c9c9":"rgb(200, 200, 200)"},iconColorCom(){return this.iconColor?this.iconColor:this.plain?this.color?this.color:this.type:"info"===this.type?"#000000":"#ffffff"},baseColor(){let e={};return this.color&&(e.color=this.plain?this.color:"white",this.plain||(e["background-color"]=this.color),-1!==this.color.indexOf("gradient")?(e.borderTopWidth=0,e.borderRightWidth=0,e.borderBottomWidth=0,e.borderLeftWidth=0,this.plain||(e.backgroundImage=this.color)):(e.borderColor=this.color,e.borderWidth="1px",e.borderStyle="solid")),e},nvueTextStyle(){let e={};return"info"===this.type&&(e.color="#323233"),this.color&&(e.color=this.plain?this.color:"white"),e.fontSize=this.textSize+"px",e},textSize(){let e=14,{size:t}=this;return"large"===t&&(e=16),"normal"===t&&(e=14),"small"===t&&(e=12),"mini"===t&&(e=10),e}},emits:["click","getphonenumber","getuserinfo","error","opensetting","launchapp"],methods:{clickHandler(){this.disabled||this.loading||uni.$u.throttle((()=>{this.$emit("click")}),this.throttleTime)},getphonenumber(e){this.$emit("getphonenumber",e)},getuserinfo(e){this.$emit("getuserinfo",e)},error(e){this.$emit("error",e)},opensetting(e){this.$emit("opensetting",e)},launchapp(e){this.$emit("launchapp",e)}}},[["render",function(e,t,a,y,v,S){const x=P(o("u-loading-icon"),N),_=f,z=P(o("u-icon"),I),C=b;return l(),s(C,{"hover-start-time":Number(e.hoverStartTime),"hover-stay-time":Number(e.hoverStayTime),"form-type":e.formType,"open-type":e.openType,"app-parameter":e.appParameter,"hover-stop-propagation":e.hoverStopPropagation,"send-message-title":e.sendMessageTitle,"send-message-path":e.sendMessagePath,lang:e.lang,"data-name":e.dataName,"session-from":e.sessionFrom,"send-message-img":e.sendMessageImg,"show-message-card":e.showMessageCard,onGetphonenumber:S.getphonenumber,onGetuserinfo:S.getuserinfo,onError:S.error,onOpensetting:S.opensetting,onLaunchapp:S.launchapp,"hover-class":e.disabled||e.loading?"":"u-button--active",class:g(["u-button u-reset-button",S.bemClass]),style:c([S.baseColor,e.$u.addStyle(e.customStyle)]),onClick:S.clickHandler},{default:i((()=>[e.loading?(l(),n(r,{key:0},[u(x,{mode:e.loadingMode,size:1.15*e.loadingSize,color:S.loadingColor},null,8,["mode","size","color"]),u(_,{class:"u-button__loading-text",style:c([{fontSize:S.textSize+"px"}])},{default:i((()=>[d(p(e.loadingText||e.text),1)])),_:1},8,["style"])],64)):(l(),n(r,{key:1},[e.icon?(l(),s(z,{key:0,name:e.icon,color:S.iconColorCom,size:1.35*S.textSize,customStyle:{marginRight:"2px"}},null,8,["name","color","size"])):m("",!0),h(e.$slots,"default",{},(()=>[u(_,{class:"u-button__text",style:c([{fontSize:S.textSize+"px"}])},{default:i((()=>[d(p(e.text),1)])),_:1},8,["style"])]),!0)],64))])),_:3},8,["hover-start-time","hover-stay-time","form-type","open-type","app-parameter","hover-stop-propagation","send-message-title","send-message-path","lang","data-name","session-from","send-message-img","show-message-card","onGetphonenumber","onGetuserinfo","onError","onOpensetting","onLaunchapp","hover-class","style","onClick","class"])}],["__scopeId","data-v-3274ac45"]]),W=G({__name:"edit",setup(e){const t=y.database();$((()=>{j().then((e=>{N.value.province=e}))})),F((()=>{b.value=this}));const a=v(!1),n=v(null),r=v(!1),c=v(!1),d=v(!1),p=v(!1),h=v(!1),b=v(null),N=v({title:"",content:"",description:"",picurls:"",province:""}),I=async()=>{const e=await x().in(b.value);await e.select(".myEdita").fields({context:!0,size:!0},(e=>{console.log(e),n.value=e.context})),await e.exec()},G=(e,t,a)=>{t.hasOwnProperty(e)?a.value=!0:a.value=!1},W=e=>{let t=e.detail;G("header",t,r),G("bold",t,c),G("italic",t,d)},E=()=>{a.value=!0},L=()=>{h.value=!h.value,console.log(n.value),n.value.insertDivider()},D=()=>{r.value=!r.value,n.value.format("header",!!r.value&&"H2")},H=()=>{c.value=!c.value,n.value.format("bold")},R=()=>{d.value=!d.value,n.value.format("italic")},V=()=>{a.value=!1},q=()=>{p.value=!p.value,_({success:async e=>{console.log(e.tempFiles),z({title:"上传中,请稍后",mask:!0});for(let t of e.tempFiles){let e=await y.uploadFile({filePath:t.path,cloudPath:t.name});n.value.insertImage({src:e.fileID})}C()}})},J=()=>{n.value.getContents({success:e=>{console.log(e),N.value.description=e.text.slice(0,50),N.value.content=e.html,N.value.picurls=B(e.html),console.log(N.value),z({title:"发布中..."}),K()}})},K=()=>{t.collection("quanzi_aticle").add({...N.value}).then((e=>{C(),T({title:"发布成功"}),setTimeout((()=>{k({url:"/pages/index/index"})}),800)}))};return(e,t)=>{const n=w,b=S,y=M,v=P(o("u-button"),O),x=f;return l(),s(b,{class:"edit"},{default:i((()=>[u(b,{class:"title"},{default:i((()=>[u(n,{type:"text",modelValue:N.value.title,"onUpdate:modelValue":t[0]||(t[0]=e=>N.value.title=e),placeholder:"请输入标题","placeholder-class":"placeholderClass"},null,8,["modelValue"])])),_:1}),u(b,{class:"content"},{default:i((()=>[u(y,{class:"myEdita",placeholder:"请输入内容","show-img-size":"","show-img-toolbar":"","show-img-resize":"",onReady:I,onFocus:E,onStatuschange:W})])),_:1}),u(b,{class:"btnGroup"},{default:i((()=>[u(v,{onClick:J,type:"primary",text:"确认发表",disabled:!N.value.title.length},null,8,["disabled"])])),_:1}),a.value?(l(),s(b,{key:0,class:"tools"},{default:i((()=>[u(b,{class:"item",onClick:D},{default:i((()=>[u(x,{class:g(["iconfont icon-zitibiaoti",r.value?"active":""])},null,8,["class"])])),_:1}),u(b,{class:"item",onClick:H},{default:i((()=>[u(x,{class:g(["iconfont icon-zitijiacu",c.value?"active":""])},null,8,["class"])])),_:1}),u(b,{class:"item",onClick:R},{default:i((()=>[u(x,{class:g(["iconfont icon-zitixieti",d.value?"active":""])},null,8,["class"])])),_:1}),u(b,{class:"item",onClick:L},{default:i((()=>[u(x,{class:g(["iconfont icon-fengexian",h.value?"active":""])},null,8,["class"])])),_:1}),u(b,{class:"item",onClick:q},{default:i((()=>[u(x,{class:g(["iconfont icon-charutupian",p.value?"active":""])},null,8,["class"])])),_:1}),u(b,{class:"item",onClick:V},{default:i((()=>[u(x,{class:"iconfont icon-duigou_kuai"})])),_:1})])),_:1})):m("",!0)])),_:1})}}},[["__scopeId","data-v-623557f8"]]);export{W as default};
