import{U as t,r as e,o,c as i,w as n,n as a,e as s,g as l,f as r,j as c,F as u,k as f,b as m,t as h,l as d,E as b,i as p,D as _,v as g,x as y,y as k,z as v,Q as C,B as x,ak as D,J as w}from"./index-6f7f74a6.js";import{_ as B}from"./uni-forms-item.3fa67a8a.js";import{r as S}from"./uni-app.es.6c04d0ca.js";import{v as z,_ as j}from"./opendb-feedback.291b68d6.js";import{_ as P}from"./uni-easyinput.46fdb077.js";import{_ as T}from"./uni-forms.6270aa8b.js";import{_ as V}from"./uni-icons.bcdec7e2.js";import{_ as F}from"./_plugin-vue_export-helper.1b428a4d.js";const I=F({name:"UniFab",emits:["fabClick","trigger"],props:{pattern:{type:Object,default:()=>({})},horizontal:{type:String,default:"left"},vertical:{type:String,default:"bottom"},direction:{type:String,default:"horizontal"},content:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},popMenu:{type:Boolean,default:!0}},data:()=>({fabShow:!1,isShow:!1,isAndroidNvue:!1,styles:{color:"#3c3e49",selectedColor:"#007AFF",backgroundColor:"#fff",buttonColor:"#007AFF",iconColor:"#fff",icon:"plusempty"}}),computed:{contentWidth(t){return 55*(this.content.length+1)+15+"px"},contentWidthMin:()=>"55px",boxWidth(){return this.getPosition(3,"horizontal")},boxHeight(){return this.getPosition(3,"vertical")},leftBottom(){return this.getPosition(0,"left","bottom")},rightBottom(){return this.getPosition(0,"right","bottom")},leftTop(){return this.getPosition(0,"left","top")},rightTop(){return this.getPosition(0,"right","top")},flexDirectionStart(){return this.getPosition(1,"vertical","top")},flexDirectionEnd(){return this.getPosition(1,"vertical","bottom")},horizontalLeft(){return this.getPosition(2,"horizontal","left")},horizontalRight(){return this.getPosition(2,"horizontal","right")},nvueBottom:()=>(t().windowBottom,30)},watch:{pattern:{handler(t,e){this.styles=Object.assign({},this.styles,t)},deep:!0}},created(){this.isShow=this.show,0===this.top&&(this.fabShow=!0),this.styles=Object.assign({},this.styles,this.pattern)},methods:{_onClick(){this.$emit("fabClick"),this.popMenu&&(this.isShow=!this.isShow)},open(){this.isShow=!0},close(){this.isShow=!1},_onItemClick(t,e){this.isShow&&this.$emit("trigger",{index:t,item:e})},getPosition(t,e,o){return 0===t?this.horizontal===e&&this.vertical===o:1===t?this.direction===e&&this.vertical===o:2===t?this.direction===e&&this.horizontal===o:this.isShow&&this.direction===e?this.contentWidth:this.contentWidthMin}}},[["render",function(t,_,g,y,k,v){const C=d,x=b,D=p,w=S(e("uni-icons"),V);return o(),i(C,{class:"uni-cursor-point"},{default:n((()=>[g.popMenu&&(v.leftBottom||v.rightBottom||v.leftTop||v.rightTop)&&g.content.length>0?(o(),i(C,{key:0,class:a([{"uni-fab--leftBottom":v.leftBottom,"uni-fab--rightBottom":v.rightBottom,"uni-fab--leftTop":v.leftTop,"uni-fab--rightTop":v.rightTop},"uni-fab"]),style:s(v.nvueBottom)},{default:n((()=>[l(C,{class:a([{"uni-fab__content--left":"left"===g.horizontal,"uni-fab__content--right":"right"===g.horizontal,"uni-fab__content--flexDirection":"vertical"===g.direction,"uni-fab__content--flexDirectionStart":v.flexDirectionStart,"uni-fab__content--flexDirectionEnd":v.flexDirectionEnd,"uni-fab__content--other-platform":!k.isAndroidNvue},"uni-fab__content"]),style:s({width:v.boxWidth,height:v.boxHeight,backgroundColor:k.styles.backgroundColor}),elevation:"5"},{default:n((()=>[v.flexDirectionStart||v.horizontalLeft?(o(),i(C,{key:0,class:"uni-fab__item uni-fab__item--first"})):r("",!0),(o(!0),c(u,null,f(g.content,((t,e)=>(o(),i(C,{key:e,class:a([{"uni-fab__item--active":k.isShow},"uni-fab__item"]),onClick:o=>v._onItemClick(e,t)},{default:n((()=>[l(x,{src:t.active?t.selectedIconPath:t.iconPath,class:"uni-fab__item-image",mode:"aspectFit"},null,8,["src"]),l(D,{class:"uni-fab__item-text",style:s({color:t.active?k.styles.selectedColor:k.styles.color})},{default:n((()=>[m(h(t.text),1)])),_:2},1032,["style"])])),_:2},1032,["class","onClick"])))),128)),v.flexDirectionEnd||v.horizontalRight?(o(),i(C,{key:1,class:"uni-fab__item uni-fab__item--first"})):r("",!0)])),_:1},8,["class","style"])])),_:1},8,["class","style"])):r("",!0),l(C,{class:a([{"uni-fab__circle--leftBottom":v.leftBottom,"uni-fab__circle--rightBottom":v.rightBottom,"uni-fab__circle--leftTop":v.leftTop,"uni-fab__circle--rightTop":v.rightTop,"uni-fab__content--other-platform":!k.isAndroidNvue},"uni-fab__circle uni-fab__plus"]),style:s({"background-color":k.styles.buttonColor,bottom:v.nvueBottom}),onClick:v._onClick},{default:n((()=>[l(w,{class:a(["fab-circle-icon",{"uni-fab__plus--active":k.isShow&&g.content.length>0}]),type:k.styles.icon,color:k.styles.iconColor,size:"32"},null,8,["type","color","class"])])),_:1},8,["class","style","onClick"])])),_:1})}],["__scopeId","data-v-b7eca566"]]);console.log(z);const O=_.database();function U(t){let e={};for(let o in z)t.indexOf(o)>-1&&(e[o]=z[o]);return e}const A=F({data(){let t={content:"",imgs:[],contact:"",mobile:""};return{formData:t,formOptions:{},rules:{...U(Object.keys(t))}}},onReady(){this.$refs.form.setRules(this.rules)},methods:{fabClick(){g({url:"/uni_modules/uni-feedback/pages/opendb-feedback/list"})},submit(){y({mask:!0}),this.$refs.form.validate().then((t=>{this.submitForm(t)})).catch((()=>{k()}))},submitForm(t){O.collection("opendb-feedback").add(t).then((t=>{v({icon:"none",title:"提交成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>C()),500)})).catch((t=>{x({content:t.message||"请求服务失败",showCancel:!1})})).finally((()=>{k()}))}}},[["render",function(t,a,s,c,u,f){const h=D,b=S(e("uni-forms-item"),B),p=S(e("uni-file-picker"),j),_=S(e("uni-easyinput"),P),g=w,y=d,k=S(e("uni-forms"),T),v=S(e("uni-fab"),I);return o(),i(y,{class:"uni-container"},{default:n((()=>[l(k,{ref:"form",value:u.formData,"validate-trigger":"submit","err-show-type":"toast"},{default:n((()=>[l(b,{name:"content",label:"留言内容/回复内容",required:""},{default:n((()=>[l(h,{onInput:a[0]||(a[0]=e=>t.binddata("content",e.detail.value)),class:"uni-textarea-border",modelValue:u.formData.content,"onUpdate:modelValue":a[1]||(a[1]=t=>u.formData.content=t),trim:"right"},null,8,["modelValue"])])),_:1}),l(b,{name:"imgs",label:"图片列表"},{default:n((()=>[l(p,{"file-mediatype":"image",limit:6,"return-type":"array",modelValue:u.formData.imgs,"onUpdate:modelValue":a[2]||(a[2]=t=>u.formData.imgs=t)},null,8,["modelValue"])])),_:1}),l(b,{name:"contact",label:"联系人"},{default:n((()=>[l(_,{modelValue:u.formData.contact,"onUpdate:modelValue":a[3]||(a[3]=t=>u.formData.contact=t),trim:"both"},null,8,["modelValue"])])),_:1}),l(b,{name:"mobile",label:"联系电话"},{default:n((()=>[l(_,{modelValue:u.formData.mobile,"onUpdate:modelValue":a[4]||(a[4]=t=>u.formData.mobile=t),trim:"both"},null,8,["modelValue"])])),_:1}),l(y,{class:"uni-button-group"},{default:n((()=>[l(g,{type:"primary",class:"uni-button",onClick:f.submit},{default:n((()=>[m("提交")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["value"]),t.uniIDHasRole("webmaster")||t.uniIDHasRole("admin")?(o(),i(v,{key:0,ref:"fab",horizontal:"right",vertical:"bottom","pop-menu":!1,onFabClick:f.fabClick},null,8,["onFabClick"])):r("",!0)])),_:1})}],["__scopeId","data-v-fb5880bd"]]);export{A as default};
