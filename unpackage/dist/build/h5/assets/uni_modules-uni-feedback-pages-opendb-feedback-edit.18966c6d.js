import{D as e,x as t,y as a,z as o,Q as n,B as s,o as l,c as i,w as m,l as r,g as u,b as d,ak as c,r as f,J as p}from"./index-6f7f74a6.js";import{_ as b}from"./uni-forms-item.3fa67a8a.js";import{r as h}from"./uni-app.es.6c04d0ca.js";import{v as g,_ as D}from"./opendb-feedback.291b68d6.js";import{_}from"./uni-easyinput.46fdb077.js";import{_ as y}from"./uni-forms.6270aa8b.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-icons.bcdec7e2.js";const k=e.database();function j(e){let t={};for(let a in g)e.indexOf(a)>-1&&(t[a]=g[a]);return t}const v=V({data(){let e={content:"",imgs:[],contact:"",mobile:""};return{formData:e,formOptions:{},rules:{...j(Object.keys(e))}}},onLoad(e){if(e.id){const t=e.id;this.formDataId=t,this.getDetail(t)}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){t({mask:!0}),this.$refs.form.validate().then((e=>{this.submitForm(e)})).catch((()=>{a()}))},submitForm(e){k.collection("opendb-feedback").doc(this.formDataId).update(e).then((e=>{o({icon:"none",title:"修改成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>n()),500)})).catch((e=>{s({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{a()}))},getDetail(e){t({mask:!0}),k.collection("opendb-feedback").doc(e).field("content,imgs,contact,mobile").get().then((e=>{const t=e.result.data[0];t&&(this.formData=t)})).catch((e=>{s({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{a()}))}}},[["render",function(e,t,a,o,n,s){const g=c,V=h(f("uni-forms-item"),b),k=h(f("uni-file-picker"),D),j=h(f("uni-easyinput"),_),v=p,x=r,C=h(f("uni-forms"),y);return l(),i(x,{class:"uni-container"},{default:m((()=>[u(C,{ref:"form",value:n.formData,"validate-trigger":"submit","err-show-type":"toast"},{default:m((()=>[u(V,{name:"content",label:"留言内容/回复内容",required:""},{default:m((()=>[u(g,{onInput:t[0]||(t[0]=t=>e.binddata("content",t.detail.value)),class:"uni-textarea-border",modelValue:n.formData.content,"onUpdate:modelValue":t[1]||(t[1]=e=>n.formData.content=e),trim:"right"},null,8,["modelValue"])])),_:1}),u(V,{name:"imgs",label:"图片列表"},{default:m((()=>[u(k,{"file-mediatype":"image",limit:6,"return-type":"array",modelValue:n.formData.imgs,"onUpdate:modelValue":t[2]||(t[2]=e=>n.formData.imgs=e)},null,8,["modelValue"])])),_:1}),u(V,{name:"contact",label:"联系人"},{default:m((()=>[u(j,{modelValue:n.formData.contact,"onUpdate:modelValue":t[3]||(t[3]=e=>n.formData.contact=e),trim:"both"},null,8,["modelValue"])])),_:1}),u(V,{name:"mobile",label:"联系电话"},{default:m((()=>[u(j,{modelValue:n.formData.mobile,"onUpdate:modelValue":t[4]||(t[4]=e=>n.formData.mobile=e),trim:"both"},null,8,["modelValue"])])),_:1}),u(x,{class:"uni-button-group"},{default:m((()=>[u(v,{type:"primary",class:"uni-button",onClick:s.submit},{default:m((()=>[d("提交")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-f6e45a49"]]);export{v as default};
